!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.beadnet=t()}(this,function(){"use strict";var t=["Lester","Margot","Abdul","Avery","Clara","Ewald","Kendall","Leda","Dawn","Quinn","Dane","Buster","Patience","Carlee","Maud","Jacey","Samara","Alene","Kaylin","Hubert","Al","Franco","Mervin","Neha","Kole","Candida","Enoch","Pansy","Ryder","Everett","Mabel","Tavares","Landen","Jocelyn","Bryon","Dayne","Derek","Kyla","Estevan","Orval","Violette","Daija","Stella","Zelma","Robyn","Colby","Joyce","Cruz","Pedro","Leanna","Emanuel","Mozelle","Hans","Randal","Ivy","Marco","Abbey","Shea","Ethan","Novella","Abel","Kale","Irma","Esther","Ransom","Glennie","Edmund","Aric","Aiyana","Trenton","Dana","Wade","Tyrell","Timmy","Dudley","Macy","Marilie","Kaley","Gayle","Eda","Max","Kaitlyn","Josie","Lea","Nico","Marc"];function n(e){return t[Math.floor(Math.random()*t.length)]}var o="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var e,a=(function(e){var t,n;t=o,n=function(){var a=function(){},l="undefined",c=["trace","debug","info","warn","error"];function r(t,e){var n=t[e];if("function"==typeof n.bind)return n.bind(t);try{return Function.prototype.bind.call(n,t)}catch(e){return function(){return Function.prototype.apply.apply(n,[t,arguments])}}}function d(e,t){for(var n=0;n<c.length;n++){var o=c[n];this[o]=n<e?a:this.methodFactory(o,e,t)}this.log=this.debug}function h(e,t,n){return"debug"===(o=e)&&(o="log"),typeof console!==l&&(void 0!==console[o]?r(console,o):void 0!==console.log?r(console,"log"):a)||function(e,t,n){return function(){typeof console!==l&&(d.call(this,t,n),this[e].apply(this,arguments))}}.apply(this,arguments);var o}function n(n,e,t){var o,a=this,r="loglevel";function i(){var e;if(typeof window!==l){try{e=window.localStorage[r]}catch(e){}if(typeof e===l)try{var t=window.document.cookie,n=t.indexOf(encodeURIComponent(r)+"=");-1!==n&&(e=/^([^;]+)/.exec(t.slice(n))[1])}catch(e){}return void 0===a.levels[e]&&(e=void 0),e}}n&&(r+=":"+n),a.name=n,a.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},a.methodFactory=t||h,a.getLevel=function(){return o},a.setLevel=function(e,t){if("string"==typeof e&&void 0!==a.levels[e.toUpperCase()]&&(e=a.levels[e.toUpperCase()]),!("number"==typeof e&&0<=e&&e<=a.levels.SILENT))throw"log.setLevel() called with invalid level: "+e;if(o=e,!1!==t&&function(e){var t=(c[e]||"silent").toUpperCase();if(typeof window!==l){try{return window.localStorage[r]=t}catch(e){}try{window.document.cookie=encodeURIComponent(r)+"="+t+";"}catch(e){}}}(e),d.call(a,e,n),typeof console===l&&e<a.levels.SILENT)return"No console available for logging"},a.setDefaultLevel=function(e){i()||a.setLevel(e,!1)},a.enableAll=function(e){a.setLevel(a.levels.TRACE,e)},a.disableAll=function(e){a.setLevel(a.levels.SILENT,e)};var s=i();null==s&&(s=null==e?"WARN":e),a.setLevel(s,!1)}var o=new n,i={};o.getLogger=function(e){if("string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=i[e];return t||(t=i[e]=new n(e,o.getLevel(),o.methodFactory)),t};var e=typeof window!==l?window.log:void 0;return o.noConflict=function(){return typeof window!==l&&window.log===o&&(window.log=e),o},o.getLoggers=function(){return i},o},e.exports?e.exports=n():t.log=n()}(e={exports:{}},e.exports),e.exports);a.enableAll(),a.setLevel("TRACE");var r={colorScheme:d3.scaleOrdinal(d3.schemeCategory10),container:{selector:"#beadnet",backgroundColor:"#FFF"},nodes:{radius:30,color:null,strokeWidth:3,strokeColor:null},channels:{color:"lightgray",strokeWidth:3,strokeColor:null}};var i=function(){function o(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(e,t,n){return t&&o(e.prototype,t),n&&o(e,n),e}}();return function(){function o(e){var t,n;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,o),this._opt=(t=e,n={},Object.assign(n,r,t),n.nodes.color=n.nodes.color||n.colorScheme(0),n.nodes.strokeColor=n.nodes.strokeColor||n.container.backgroundColor,n),a.debug("initializing beadnet with options: ",this._opt),this.container=document.querySelector(this._opt.container.selector),this.svg=d3.select(this.container).append("svg").attr("class","beadnet"),this.updateSVGSize(),this.chart=this.svg.append("g").attr("class","chart").attr("transform","translate(0,0) scale(1)"),this.channelContainer=this.chart.append("g").attr("class","channels"),this.nodeContainer=this.chart.append("g").attr("class","nodes"),this._nodes=[],this._channels=[],this.simulation=this._createSimulation(),this.updateSimulationCenter(),this.behaviors=this.createBehaviors(),this.svg.call(this.behaviors.zoom),this._updateNodes(),window.addEventListener("resize",this.onResize.bind(this))}return i(o,[{key:"_createSimulation",value:function(){return d3.forceSimulation(this._nodes).force("charge",d3.forceManyBody().strength(-5e3)).force("link",d3.forceLink(this._channels).distance(this.forceDistance)).force("x",d3.forceX()).force("y",d3.forceY()).alphaTarget(.1).on("tick",this.ticked.bind(this))}},{key:"updateSVGSize",value:function(){this.width=+this.container.clientWidth,this.height=+this.container.clientHeight,this.forceDistance=.1*(this.width+this.height),this.svg.attr("width",this.width).attr("height",this.height)}},{key:"onResize",value:function(){this.updateSVGSize(),this.updateSimulationCenter(),this.createBehaviors()}},{key:"createBehaviors",value:function(){var e=this;return{zoom:d3.zoom().scaleExtent([.1,5,4]).on("zoom",function(){return e.chart.attr("transform",d3.event.transform)}),drag:d3.drag().on("start",this.onDragStart.bind(this)).on("drag",this.onDragged.bind(this)).on("end",this.onDragendEnd.bind(this))}}},{key:"updateSimulationCenter",value:function(){var e=this.svg.attr("width")/2,t=this.svg.attr("height")/2;this.simulation.force("center",d3.forceCenter(e,t)).restart()}},{key:"_updateNodes",value:function(){this.nodeElements=this.nodeContainer.selectAll(".node").data(this._nodes,function(e){return e.id}),this.nodeElements.exit().remove();var e=this.nodeElements.enter().append("g").attr("class","node").attr("id",function(e){return e.id}).attr("balance",function(e){return e.balance}).style("stroke",this._opt.nodes.strokeColor).style("stroke-width",this._opt.nodes.strokeWidth);return e.append("circle").attr("r",this._opt.nodes.radius).attr("fill",function(e){return e.color}).style("cursor","pointer"),e.append("text").style("stroke-width",.5).attr("stroke",this._opt.nodes.strokeColor).attr("fill",this._opt.nodes.strokeColor).attr("font-family","sans-serif").attr("font-size","15px").attr("y","5px").attr("text-anchor","middle").attr("pointer-events","none").text(function(e){return e.balance||e.id}),e.append("title").text(function(e){return e.id}),e.call(this.behaviors.drag),this.simulation.nodes(this._nodes).alpha(1).restart(),this.nodeElements=this.nodeContainer.selectAll(".node"),this.nodeElements}},{key:"addNode",value:function(e){return(e=e||{}).id=e.id||n(),e.channelCount=0,e.color=e.color||this._opt.colorScheme(this._nodes.length%10),this._nodes.push(e),this._updateNodes(),this}},{key:"addNodes",value:function(e){var t=this;return e.forEach(function(e){return t.addNode(e)}),this}},{key:"removeNode",value:function(t){return this._nodes=this._nodes.filter(function(e){return e.id!=t}),this._updateNodes(),this}},{key:"createRandomNode",value:function(){return{id:n()}}},{key:"getRandomNode",value:function(){return this._nodes[Math.floor(Math.random()*this._nodes.length)]}},{key:"_updateChannels",value:function(){return this._channelElements=this.channelContainer.selectAll(".channel").data(this._channels),this._channelElements.exit().remove(),this._channelElements.enter().append("g").attr("class","channel").attr("source-balance",function(e){return e.sourceBalance}).attr("target-balance",function(e){return e.targetBalance}).attr("source-id",function(e){return e.source.id}).attr("target-id",function(e){return e.target.id}).append("path").style("stroke-width",this._opt.channels.strokeWidth).style("stroke",this._opt.channels.color).style("fill","none"),this.paths=this.channelContainer.selectAll(".channel path"),this._channelElements}},{key:"addChannel",value:function(e){var t=d3.map(this._nodes,function(e){return e.id}),n=t.get(e.source),o=t.get(e.target);this._channels.push({source:n,target:o,sourceBalance:e.sourceBalance,targetBalance:e.targetBalance}),n.channelCount=n.channelCount+1,o.channelCount=o.channelCount+1,this._updateChannels(),this.simulation.force("link").links(this._channels),this.simulation.alpha(1).restart()}},{key:"addChannels",value:function(e){var t=this;e.forEach(function(e){return t.addChannel(e)})}},{key:"createRandomChannel",value:function(){var e=this.getRandomNode(),t=this.getRandomNode();return{source:e.id,target:t.id,sourceBalance:Math.floor(10*Math.random()),targetBalance:Math.floor(10*Math.random())}}},{key:"ticked",value:function(){var r=this;this.nodeElements&&this.nodeElements.attr("transform",function(e){return"translate("+e.x+","+e.y+")"}),this.paths&&this.paths.attr("d",function(t){var e=r._channels.filter(function(e){return t.source.id==t.source.id&&t.target.id==t.target.id}).length;if(e<=1)return"M"+t.source.x+","+t.source.y+" "+t.target.x+","+t.target.y;var n=t.target.x-t.source.x,o=t.target.y-t.source.y,a=Math.sqrt(n*n+e+(o*o+e));return"M"+t.source.x+","+t.source.y+"A"+a+","+a+" 0 0,1 "+t.target.x+","+t.target.y})}},{key:"onDragStart",value:function(e){d3.event.active||this.simulation.alphaTarget(.1).restart(),e.fx=e.x,e.fy=e.y}},{key:"onDragged",value:function(e){e.fx=d3.event.x,e.fy=d3.event.y}},{key:"onDragendEnd",value:function(e){d3.event.active||this.simulation.alphaTarget(0),e.fx=null,e.fy=null}}]),o}()});
//# sourceMappingURL=beadnet.standalone.min.js.map
